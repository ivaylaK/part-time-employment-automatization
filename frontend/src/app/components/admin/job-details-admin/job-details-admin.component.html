<div *ngIf="job">
  <h4 class="mb-2">{{ job.title }}</h4>
  <div class="text-muted mb-2">
    Client: {{ job.client }} • {{ job.city }} • {{ job.location }}
  </div>
  <div class="mb-3">
    <strong>Job time period:</strong>
    {{ job.startDate | date:'mediumDate' }} – {{ job.endDate | date:'mediumDate' }}
    <span class="ms-3" *ngIf="availableSlots() !== 0">Available slots: {{ availableSlots() }}</span>
    <span class="ms-3 text-danger" *ngIf="availableSlots() === 0">Job has no available slots!</span>
  </div>
</div>

<table class="table table-sm">
  <thead>
  <tr><th>Name</th><th>Phone Number</th><th></th></tr>
  </thead>
  <tbody>
  <tr *ngFor="let a of jobApplicants">
    <td>{{ a.firstName }} {{ a.lastName }}</td>
    <td>{{ a.number }}</td>
    <td class="text-end">
      <button class="btn btn-sm btn-outline-danger" (click)="removeApplicantAsAdmin(a.id!)">Remove</button>
    </td>
  </tr>
  </tbody>
</table>

<div class="mt-3">
  <div class="d-flex align-items-center gap-2">
    <select class="form-select w-auto" [(ngModel)]="selectedApplicant" [disabled]="availableSlots() === 0">
      <option [ngValue]="undefined">Pick a user</option>
      <option *ngFor="let a of allApplicants" [ngValue]="a">{{ a.firstName }} {{ a.lastName }} ({{ a.number }})</option>
    </select>
    <button class="btn btn-primary" (click)="addApplicantAsAdmin()" [disabled]="availableSlots() === 0 || !selectedApplicant">
      Add an applicant
    </button>
  </div>

  <div *ngIf="minDate && maxDate" class="my-3">
    <h6>Dates for this user</h6>
    <div class="mb-2 text-secondary fw-semibold text-capitalize" *ngIf="currentView">
      {{ monthLabel }}
    </div>

    <ngb-datepicker
      *ngIf="minDate && maxDate"
      [startDate]="minDate"
      [minDate]="minDate"
      [maxDate]="maxDate"
      [outsideDays]="'hidden'"
      [displayMonths]="1"
      [navigation]="'arrows'"
      [markDisabled]="markDisabled"
      (navigate)="onNavigate($event.next)"
      (select)="onDateSelection($event)"
      [dayTemplate]="t">
    </ngb-datepicker>

    <ng-template #t let-date="date" let-disabled="disabled" let-currentMonth="currentMonth">
  <span
    class="d-inline-block w-100 h-100 text-center rounded"
    [class.bg-primary]="isSelected(date) && !disabled"
    [class.text-white]="isSelected(date) && !disabled"
    [class.text-muted]="date.month !== currentMonth"
    [class.opacity-50]="disabled">
    {{ date.day }}
  </span>
    </ng-template>


    <div class="mt-2" *ngIf="selectedDates.length">
      <small class="text-muted">Picked: {{ chosenDaysIso.join(', ') }}</small>
    </div>
  </div>
</div>
